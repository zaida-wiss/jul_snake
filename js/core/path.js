// core/path.js
// =====================================================
// PATH byggd EXAKT fr√•n sifferkartan (din bild)
//
// Regler:
// - 16√ó16 grid
// - Varje ruta har ett unikt nummer
// - Pilarna betyder: f√§rdriktning √§r fr√•n H√ñGRE ‚Üí L√ÑGRE
// - PATH[0]   = ruta 1  (ü¶å ren)
// - PATH[1]   = ruta 2  (üéÖ tomte)
// - PATH[2..] = paket
// =====================================================

export const GRID_SIZE = 16;

/*
  INDEX_MAP[y][x] = siffran i rutan
  ‚ö†Ô∏è Denna matris m√•ste matcha bilden exakt
*/
const INDEX_MAP = [
  [  3,   2,   1, 256, 255, 254, 253, 252, 251, 250, 249, 248, 247, 246, 245, 244, 243 ],
  [  4,  33,  34, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243 ],
  [  5,  32,  35, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218 ],
  [  6,  31,  36, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217 ],
  [  7,  30,  37, 204, 203, 202, 201, 200, 199, 198, 197, 196, 195, 194, 193, 192 ],
  [  8,  29,  38, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191 ],
  [  9,  28,  39, 178, 177, 176, 175, 174, 173, 172, 171, 170, 169, 168, 167, 166 ],
  [ 10,  27,  40,  57,  58,  75,  76,  93,  94, 111, 112, 129, 130, 147, 148, 165 ],
  [ 11,  26,  41,  56,  59,  74,  77,  92,  95, 110, 113, 128, 131, 146, 149, 164 ],
  [ 12,  25,  42,  55,  60,  73,  78,  91,  96, 109, 114, 127, 132, 145, 150, 163 ],
  [ 13,  24,  43,  54,  61,  72,  79,  90,  97, 108, 115, 126, 133, 144, 151, 162 ],
  [ 14,  23,  44,  53,  62,  71,  80,  89,  98, 107, 116, 125, 134, 143, 152, 161 ],
  [ 15,  22,  45,  52,  63,  70,  81,  88,  99, 106, 117, 124, 135, 142, 153, 160 ],
  [ 16,  21,  46,  51,  64,  69,  82,  87, 100, 105, 118, 123, 136, 141, 154, 159 ],
  [ 17,  20,  47,  50,  65,  68,  83,  86, 101, 104, 119, 122, 137, 140, 155, 158 ],
  [ 18,  19,  48,  49,  66,  67,  84,  85, 102, 103, 120, 121, 138, 139, 156, 157 ],
];

/* =====================================================
   Bygg PATH genom att f√∂lja siffrorna 1 ‚Üí 255
   ===================================================== */

function buildPathFromIndexMap(map) {
  const lookup = new Map();

  for (let y = 0; y < GRID_SIZE; y++) {
    for (let x = 0; x < GRID_SIZE; x++) {
      lookup.set(map[y][x], { x, y });
    }
  }

  const path = [];
  for (let n = 1; n <= 255; n++) {
    if (!lookup.has(n)) {
      throw new Error(`Saknar ruta f√∂r nummer ${n} i INDEX_MAP`);
    }
    path.push(lookup.get(n));
  }

  return path;
}

export const PATH = buildPathFromIndexMap(INDEX_MAP);
